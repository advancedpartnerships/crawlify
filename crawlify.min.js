!function(t){function o(){this.counter=0,this.complete=!0}o.prototype.stop=function(t){this.counter+=t||1,this.complete=!1},o.prototype.start=function(){this.counter>0&&this.counter--,0===this.counter&&this.fin()},o.prototype.when=function(t){this.stop();var o=this;t.done(function(){o.start()})},o.prototype.load=function(t){this.counter=0,history.pushState(null,null,t)},o.prototype.fin="function"==typeof window.callPhantom?function(){this.complete=!0,window.callPhantom(this.counter),this.reset&&this.load(this.reset)}:function(){};var n=new o;if(t.crawlify)for(var i in t.crawlify)n[i]=t.crawlify[i];t.crawlify=n}(this);