!function(t){function o(){this.counter=0,this.complete=!0}o.prototype.stop=function(t){this.counter+=t||1,this.complete=!1},o.prototype.start=function(){this.counter>0&&this.counter--,0===this.counter&&this.fin()},o.prototype.when=function(t){this.stop();var o=this;t.done(function(){o.start()})},o.prototype.load=function(t){this.counter=0,history.pushState(null,null,t)};var i="function"==typeof window.callPhantom;o.prototype.fin=i?function(){this.complete=!0,window.callPhantom(this.counter),this.reset&&this.load(this.reset)}:function(){};var n=new o;if(n.isCrawling=i,t.crawlify)for(var e in t.crawlify)n[e]=t.crawlify[e];t.crawlify=n}(window||this);